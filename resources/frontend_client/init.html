<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Fospha|Metabase</title>
    <style media="screen">
      * {
        padding: 0;
        margin: 0;
      }
      #container {
        position: absolute;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }
      #progress {
        margin-top: 75px;
      }
      #status {
        margin-top: 15px;
        text-align: center;
        font-family: Lato, 'Helvetica Neue', Helvetica, sans-serif;
        font-size: 16px;
        color: #509EE3;
      }
      progress[value] {
        -webkit-appearance: none;
        appearance: none;
        width: 200px;
        height: 5px;
      }
      progress[value]::-webkit-progress-bar {
        background-color: #DBE9FA;
        border-radius: 8px;
      }
      progress[value]::-webkit-progress-value {
        background-color: #4A90E2;
        border-radius: 8px;
      }
    </style>
  </head>
  <body>
    <div id="container">
      <svg viewBox="0 0 66 85" width="94" height="116" fill="#45B794">
            <path d="M7.22072008,11.5925476 L7.22072008,25.3726674 L2.81233577,25.3726674 L2.81233577,11.5925476 L1,11.5925476 L1,8.2578567 L2.81233577,8.2578567 L2.81233577,6.05107595 C2.81233577,3.55005776 4.3797613,1 7.9554508,1 L10.4535352,1 L10.4535352,4.72700749 L8.73916356,4.72700749 C7.71054056,4.72700749 7.22072008,5.31548236 7.22072008,6.34531338 L7.22072008,8.2578567 L10.4535352,8.2578567 L10.4535352,11.5925476 L7.22072008,11.5925476 L7.22072008,11.5925476 Z" id="Shape"></path>
            <path d="M23.9312606,23.8888214 C22.8536556,25.0657712 21.0413198,26.0465626 18.4452713,26.0465626 C15.8492227,26.0465626 14.085869,25.0167316 13.008264,23.8888214 C11.4408384,22.221476 11,20.2108535 11,17.0232813 C11,13.8357091 11.3918564,11.8250866 13.008264,10.1577412 C14.085869,8.98079145 15.8492227,8 18.4452713,8 C21.0413198,8 22.8536556,9.02983102 23.9312606,10.1577412 C25.4986862,11.8250866 25.9395246,13.8357091 25.9395246,17.0232813 C25.9395246,20.2108535 25.4986862,22.221476 23.9312606,23.8888214 M20.5025173,12.7077989 C20.0126968,12.2174032 19.3269481,11.9231658 18.4452713,11.9231658 C17.5635944,11.9231658 16.9268278,12.2174032 16.3880253,12.7077989 C15.4573664,13.6395508 15.3594023,15.1597776 15.3594023,16.9742417 C15.3594023,18.7887059 15.4573664,20.3579722 16.3880253,21.2897241 C16.8778457,21.7801198 17.5635944,22.0743572 18.3962892,22.0743572 C19.228984,22.0743572 19.9637148,21.7801198 20.4535352,21.2897241 C21.3841941,20.3579722 21.4821582,18.8377455 21.4821582,16.9742417 C21.5311403,15.1597776 21.4331762,13.6395508 20.5025173,12.7077989" id="Shape"></path>
            <path d="M34.5432354,26.0956022 C31.7512586,26.0956022 29.2531742,25.8013647 27,23.5455444 L29.8899408,20.6522097 C31.3594023,22.1233968 33.2207201,22.3195551 34.5922174,22.3195551 C36.1106609,22.3195551 37.7270685,21.8291594 37.7270685,20.5050909 C37.7270685,19.6223786 37.237248,19.0339038 35.8657507,18.8867851 L33.122756,18.5925476 C29.9389229,18.2983102 27.979641,16.8761626 27.979641,13.6395508 C27.979641,9.96158289 31.2124561,8 34.7881456,8 C37.5311403,8 39.8332965,8.49039572 41.5476682,10.059662 L38.8536556,12.8058781 C37.8250326,11.8741262 36.257607,11.6289284 34.7391636,11.6289284 C32.9758098,11.6289284 32.2410791,12.4626011 32.2410791,13.3453134 C32.2410791,13.9828278 32.5349714,14.7184214 34.0534149,14.8655401 L36.8453916,15.1597776 C40.323117,15.5030546 42.0864707,17.3665583 42.0864707,20.3579722 C42.0374887,24.2320984 38.7067094,26.0956022 34.5432354,26.0956022" id="Shape"></path>
            <path d="M56.9802427,24.4772963 C56.0006017,25.4580877 54.3841941,26.0956022 52.6698225,26.0956022 C50.8574867,26.0956022 49.5349714,25.6052065 48.4083843,24.3301776 L48.4083843,32.3236279 L44,32.3236279 L44,8.19615829 L48.2614382,8.19615829 L48.2614382,9.86350375 C49.4859894,8.49039572 50.8085047,8 52.6698225,8 C54.3841941,8 56.0006017,8.58847487 56.9802427,9.56926631 C58.7435964,11.3346909 58.7925785,14.3261048 58.7925785,16.9742417 C58.7435964,19.6223786 58.7435964,22.7118717 56.9802427,24.4772963 M51.3962892,11.9231658 C48.7512586,11.9231658 48.4083843,14.080907 48.4083843,16.9742417 C48.4083843,19.8675765 48.7512586,22.0743572 51.3962892,22.0743572 C54.0413198,22.0743572 54.3841941,19.8675765 54.3841941,16.9742417 C54.3352121,14.1299465 53.9923378,11.9231658 51.3962892,11.9231658" id="Shape"></path>
            <path d="M71.1392839,26.1274696 L71.1392839,15.3387637 C71.1392839,12.9848642 69.6698225,12.200231 68.2493431,12.200231 C66.8778457,12.200231 65.4083843,13.0339038 65.4083843,15.3387637 L65.4083843,26.1274696 L61,26.1274696 L61,2 L65.4083843,2 L65.4083843,10.0915294 C66.5839535,8.86554012 68.1023969,8.27706525 69.6208404,8.27706525 C73.4904222,8.27706525 75.4986862,10.9742417 75.4986862,14.7012492 L75.4986862,26.1274696 L71.1392839,26.1274696 L71.1392839,26.1274696 Z" id="Shape"></path>
            <path d="M88.3352121,25.8504043 L88.3352121,24.3301776 C87.159643,25.5071273 86.0330559,26.0465626 83.9758098,26.0465626 C81.9675459,26.0465626 80.4980844,25.5561669 79.4694614,24.4772963 C78.5388025,23.4965048 78,22.0743572 78,20.5050909 C78,17.7098353 79.9102999,15.4049754 84.0247919,15.4049754 L88.188266,15.4049754 L88.188266,14.5222631 C88.188266,12.6097198 87.257607,11.7270075 84.9064688,11.7270075 C83.1920971,11.7270075 82.4573664,12.1193241 81.5267074,13.1981947 L78.7347307,10.4519786 C80.4491024,8.5394353 82.1634741,8 85.1023969,8 C90.0495838,8 92.6456323,10.1087016 92.6456323,14.2280257 L92.6456323,25.8504043 L88.3352121,25.8504043 L88.3352121,25.8504043 Z M88.237248,18.3963893 L84.7595226,18.3963893 C83.1920971,18.3963893 82.3104202,19.1319829 82.3104202,20.4070118 C82.3104202,21.6330011 83.143115,22.4176343 84.8574867,22.4176343 C86.0820379,22.4176343 86.8657507,22.3195551 87.6494634,21.5839615 C88.1392839,21.1426054 88.2862301,20.4070118 88.2862301,19.3281412 L88.2862301,18.3963893 L88.237248,18.3963893 Z" id="Shape"></path>
      </svg>
      <progress id="progress" max="100" value="0"></progress>
      <div id="status">
        Starting Fospha Metabase...
      </div>
    </div>

    <script type="text/javascript">
      var messages = [
        "Polishing tables…",
        "Scaling scalars…",
        "Straightening columns…",
        "Embiggening data…",
        "Reticulating splines…"
      ];
      var progressElement = document.getElementById("progress");
      var statusElement = document.getElementById("status");

      function poll() {
        var req = new XMLHttpRequest();
        req.open("GET", "/api/health", true);
        req.onreadystatechange = function() {
          if (req.readyState === 4) {
            if (req.status === 200) {
              window.location.reload();
            } else {
              try {
                var health = JSON.parse(req.responseText);
                if (typeof health.progress === "number") {
                  var newValue = health.progress * 100;
                  if (newValue !== progressElement.value) {
                    progressElement.value = newValue;
                    statusElement.textContent = messages[Math.floor(Math.random() * messages.length)];
                  }
                }
              } catch (e) {}
              setTimeout(poll, 500);
            }
          }
        }
        req.send();
      }
      poll();
    </script>
  </body>
</html>
